#--------------------------------------------------
#-----------------General Settings-----------------
#--------------------------------------------------

set $e exec --no-startup-id

set $mod Mod4
set $mod2 Mod1
set $mod3 Mod3
set $term urxvtc
set $term2 alacritty

floating_modifier $mod

font pango:BlexMono Nerd Font 12
smart_gaps on 
smart_borders on
gaps inner 7
gaps outer 0
for_window [class="^.*"] border pixel 4

#--------------------------------------------------
#-----------------Program Keybinds----------------
#--------------------------------------------------

#Terminals
bindsym $mod+Return $e $term
bindsym $mod+shift+Return $e $term2

#Menus
bindsym $mod+space $e rofi -show drun -show-icons -drun-display-format {name}
bindsym $mod+semicolon $e rofi-pass
bindsym $mod+apostrophe $e sadmenu

#Camera and Audio
bindsym $mod+shift+v $e pavucontrol

#Editor
bindsym $mod+e $e $term -e nvim
bindsym $mod+o $e onlyoffice-desktopeditors
bindsym $mod+shift+o $e obsidian
bindsym $mod3+c $e vscodium
bindsym $mod+w $e toggler notes

#File Manager
bindsym $mod+a $e $term -e ~/code/scripts/lf/lf

#Audio Consumption
bindsym $mod+s $e toggler music
bindsym $mod+bracketleft $e "playerctl --player=spotify,cmus,%any previous"
bindsym $mod+bracketright $e "playerctl --player=spotify,cmus,%any next"
bindsym $mod+minus $e "playerctl --player=spotify,cmus,%all volume .05-"
bindsym $mod+equal $e "playerctl --player=spotify,cmus,%all volume .05+"
bindsym $mod+slash $e toggler spotifyd-spt
bindsym $mod+shift+slash $e toggler spotifyd

#Music
set $music Action: [a]udacity rofi-[b]eats [c]mus s[p]otify-tui [r]eaper [s]potify
bindsym $mod+u mode "$music"
mode "$music" {
    bindsym a $e flatpak run org.audacityteam.Audacity; mode "default"
    bindsym r $e reaper; mode "default"
    bindsym b $e rofi-beats; mode "default"
    bindsym c workspace $ws10; $e $term -e cmus; mode "default"
    bindsym s workspace $ws10; $e spotify; mode "default"
    bindsym p $e toggler spotify-tui; mode "default"
    bindsym $mod+u mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Browser
bindsym $mod+b $e brave --force-device-scale-factor=1
bindsym $mod+shift+t $e torbrowser-launcher
bindsym $mod+shift+w $e $term -e w3m -v
bindsym $mod2+l $e brave lesswrong.com

#Communication
bindsym $mod+m $e toggler gmail
bindsym $mod+shift+m $e $term -e neomutt
set $mega Action: [d]iscord [e]lement s[l]ack [s]ignal
bindsym $mod+c mode "$mega"
mode "$mega" {
    bindsym d $e discord; workspace $ws8; mode "default"
    bindsym e $e element-desktop; workspace $ws8; mode "default"
    bindsym l $e slack; workspace $ws8; mode "default"
    bindsym s $e signal-desktop; workspace $ws8; mode "default"
    bindsym $mod+c mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

# OS Control
set $quit Quit?: [y]es [n]o
bindsym $mod+shift+q mode "$quit"
mode "$quit" {
    bindsym y $e exit
    bindsym n $e mode "default"
    bindsym $mod+shift+q mode "default"
    bindsym Escape mode "default"
    bindsym Return $e exit
}
set $shutdown Shutdown?: [y]es [n]o
bindsym $mod+shift+s mode "$shutdown"
mode "$shutdown" {
    bindsym y $e shutdown now
    bindsym n $e mode "default"
    bindsym $mod+shift+s mode "default"
    bindsym Escape mode "default"
    bindsym Return mode $e shutdown now
}
set $reboot Reboot?: [y]es [n]o
bindsym $mod+shift+r mode "$reboot"
mode "$reboot" {
    bindsym y $e reboot
    bindsym n $e mode "default"
    bindsym $mod+shift+r mode "default"
    bindsym Escape mode "default"
    bindsym Return $e reboot
}
bindsym $mod+shift+i $e i3lock -i ~/pictures/wallpapers/mountains.png

#Games
set $games Action: [h]eroic [l]ichess [m]inecraft [s]team [t]etris
bindsym $mod+shift+g mode "$games"
mode "$games" {
    bindsym h $e heroic; mode "default"
    bindsym l $e brave --profile-directory=Default --app-id=pdihgkikjgccndbckbcgjmcnpkockcjg; mode "default"
    bindsym m $e xdg-launch minecraft-launcher; mode "default"
    bindsym s $e com.valvesoftware.Steam; mode "default"
    bindsym t $e $term -e netris -k "hHklLJjs frn"; mode "default"
    bindsym $mod+shift+g mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Video Entertainment
set $entertainment Action: [g]tk-pipe-viewer [n]ewsboat [p]ipe-viewer
bindsym $mod+n mode "$entertainment"
mode "$entertainment" {
    bindsym g $e gtk-pipe-viewer; workspace $ws9; mode "default"
    bindsym n $e $term -e newsboat -u .config/newsboat/urls -c .config/newsboat/cache.db -C .config/newsboat/config; workspace $ws9; mode "default"
    bindsym p $e $term -e pipe-viewer; workspace $ws9; mode "default"
    bindsym $mod+n mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}
bindsym $mod+p $e $term -e pipe-viewer --resolution=480; workspace $ws9
bindsym XF86Tools $e pomo
bindsym shift+XF86Tools $e echo "" > $XDG_CACHE_HOME/pomo.cache; $e pkill -SIGRTMIN+4 i3status-rs


#Toggles
bindsym XF86WLAN $e wifi off
bindsym shift+XF86WLAN $e wifi on
bindsym XF86Bluetooth $e bluetooth off
bindsym shift+XF86Bluetooth $e bluetooth on
bindsym $mod+shift+b $e bluetooth on; $e sleep .1 && blueman-manager
bindsym $mod+shift+n $e toggler nm-applet
bindsym $mod+shift+e $e toggler espanso
bindsym $mod+grave $e dunstctl close
bindsym $mod2+r $e toggler redshift

#Utility
bindsym $mod+t $e toggler todoist
bindsym $mod2+h $e $term -e htop
bindsym $mod2+d $e gtk-launch dash
bindsym $mod2+s $e gtk-launch snapdrop
bindsym $mod+shift+c $e toggler calendar
bindsym $mod2+c $e toggler bc
bindsym $mod+comma exec rofi -modi "clipboard:greenclip print" -show clipboard -run-command '{cmd}'
bindsym $mod+shift+comma exec pkill greenclip && greenclip clear && greenclip daemon &
bindsym XF86Display $e feh --bg-fill --no-fehbg --recursive --randomize ~/pictures/wallpapers


# Screenshots
bindsym --release Print $e scrot --select -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'
bindsym --release $mod2+Print $e scrot -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'

#--------------------------------------------------
#-----------Startup and Program Settings-----------
#--------------------------------------------------

#Startup
$e picom
$e urxvtd -q
$e dunst
$e greenclip daemon
$e blueman-applet
$e libinput-gestures-setup start
$e redshift

for_window [class="Blueman-manager"] floating enable
for_window [class="Blueman-manager"] resize set 800 500
for_window [class="Pavucontrol"] floating enable

assign [title="Tor Browser"] $ws7
assign [class="discord"] $ws8
assign [class="Slack"] $ws8
assign [class="Signal"] $ws8
assign [class="Element"] $ws8
assign [title="pipe-viewer"] $ws9
assign [title="newsboat"] $ws9
assign [title="cmus"] $ws10
assign [title="spt"] $ws10

#Rofi-Beats
for_window [title="radio-mpv"] move scratchpad

#Vimwiki
for_window [title="notes"] floating enable
for_window [title="notes"] resize set 1200 900
for_window [title="notes"] move scratchpad
for_window [title="notes"] border pixel 8

#Todoist
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] move scratchpad
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] floating enable
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] resize set 1700 1020

#Calendar
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] move scratchpad
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] floating enable
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] resize set 1900 1020

#Gmail Web
for_window [instance="crx_fmgjjmmmlfnkbppncabfkddbjimcfncm"] move scratchpad
for_window [instance="crx_fmgjjmmmlfnkbppncabfkddbjimcfncm"] floating enable
for_window [instance="crx_fmgjjmmmlfnkbppncabfkddbjimcfncm"] resize set 1900 1020

for_window [instance="calc"] floating enable
for_window [instance="calc"] resize set 800 400
for_window [instance="calc"] move scratchpad
for_window [instance="calc"] border pixel 8

#--------------------------------------------------
#-------------------Movement---------------------
#--------------------------------------------------

# Kill focused window
bindsym $mod+q kill

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+shift+h move left
bindsym $mod+shift+j move down
bindsym $mod+shift+k move up
bindsym $mod+shift+l move right

# split in horizontal orientation
bindsym $mod+g split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+shift+f fullscreen toggle

# toggle tiling / floating
bindsym $mod+f floating toggle

# change focus between tiling / floating windows
bindsym $mod+shift+space focus mode_toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+d layout tabbed
bindsym $mod+shift+d layout toggle split

#Scratchpad
bindsym $mod+y scratchpad show
bindsym $mod+shift+y move scratchpad

#Set workspace names
set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# move through workspaces sequentially
bindsym $mod+z workspace prev
bindsym $mod+x workspace next

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# move focused container to workspace
bindsym $mod+shift+1 move container to workspace $ws1
bindsym $mod+shift+2 move container to workspace $ws2
bindsym $mod+shift+3 move container to workspace $ws3
bindsym $mod+shift+4 move container to workspace $ws4
bindsym $mod+shift+5 move container to workspace $ws5
bindsym $mod+shift+6 move container to workspace $ws6
bindsym $mod+shift+7 move container to workspace $ws7
bindsym $mod+shift+8 move container to workspace $ws8
bindsym $mod+shift+9 move container to workspace $ws9
bindsym $mod+shift+0 move container to workspace $ws10

bindsym $mod+r restart

bindsym $mod2+shift+h resize shrink width 3 px or 3 ppt
bindsym $mod2+shift+j resize grow height 3 px or 3 ppt
bindsym $mod2+shift+k resize shrink height 3 px or 3 ppt
bindsym $mod2+shift+l resize grow width 3 px or 3 ppt

bar {
    font pango:BlexMono Nerd Font 12
    strip_workspace_numbers yes
    position top
    status_command i3status-rs
    colors {
        separator #928374
        background #282828
        statusline #ebdbb2
        focused_workspace #689d6a #689d6a #282828 #ffffff
        active_workspace #1d2021 #1d2021 #928374 #ffffff
        inactive_workspace #32302f #32302f #928374 #888888
        urgent_workspace #cc241d #cc241d #ebdbb2 #ffffff
    }
}

#--------------------------------------------------
#--------------Peripheral Controls-----------------
#--------------------------------------------------

# adjust screen brightness
bindsym XF86MonBrightnessUp $e xbacklight +1
bindsym XF86MonBrightnessDown $e xbacklight -1
bindsym $mod2+j $e xbacklight -3
bindsym $mod2+k $e xbacklight +3
bindsym $mod+shift+a $e xbacklight -set .00206254 #Min Brightness

bindsym XF86AudioRaiseVolume $e pamixer -i 1
bindsym XF86AudioLowerVolume $e pamixer -d 5

bindsym XF86AudioMute $e pactl set-sink-mute @DEFAULT_SINK@ toggle # && $refresh_i3status
bindsym XF86AudioMicMute $e pactl set-source-mute @DEFAULT_SOURCE@ toggle # && $refresh_i3status

#--------------------------------------------------
#-------------------Theming---------------------
#--------------------------------------------------

# Wallpaper
$e feh --bg-fill --no-fehbg ~/pictures/wallpapers/lone-tree.jpg

# set primary gruvbox colorscheme colors
set $bg #282828
set $red #cc241d
set $green #98971a
set $yellow #d79921
set $blue #458588
set $purple #b16286
set $aqua #689d68
set $gray #a89984
set $darkgray #1d2021

# class                 border|backgr|text|indicator|child_border
client.focused #689d6a #689d6a #282828 #282828
client.focused_inactive #1d2021 #1d2021 #928374 #282828
client.unfocused #32302f #32302f #928374 #282828
client.urgent #cc241d #cc241d #ebdbb2 #282828
