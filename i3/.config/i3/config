#--------------------------------------------------
#-----------------General Settings-----------------
#--------------------------------------------------

set $mod Mod4
set $mod2 Mod1
set $term urxvtc
set $term_iso urxvt
set $term2 alacritty

floating_modifier $mod

font pango:Deja Vu Sans Mono 18
smart_gaps on 
smart_borders on
gaps inner 7
gaps outer 0
for_window [class="^.*"] border pixel 4

#--------------------------------------------------
#-----------------Program Keybinds----------------
#--------------------------------------------------

#Terminals
bindsym $mod+Return exec $term
bindsym $mod2+Return exec $term2

#Rofi
bindsym $mod+space exec rofi -show drun -drun-display-format {name}
bindsym $mod2+space exec rofi -show run

#Menus
bindsym $mod+semicolon exec passmenu
bindsym $mod+apostrophe exec sadmenu

#Camera and Audio
# bindsym $mod2+c exec guvcview
bindsym $mod+shift+v exec pavucontrol

#Editor
bindsym $mod+i exec $term -e nvim
bindsym $mod+shift+i exec $term -e sudo nvim
set $editor Action: vs[c]odium [l]ibreoffice
bindsym $mod+o mode "$editor"
mode "$editor" {
    bindsym c exec vscodium; mode "default"
    bindsym l exec libreoffice; mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}
bindsym $mod+shift+w [instance="notes"] scratchpad show; [instance="notes"] move position center

#File Manager
bindsym $mod+a exec $term -e lf
bindsym $mod2+f exec nautilus

#Audio Consumption
bindsym $mod+c exec music-toggle
bindsym $mod+bracketleft exec "playerctl --player=spotify,cmus,%all previous"
bindsym $mod+bracketright exec "playerctl --player=spotify,cmus,%all next"
bindsym $mod+minus exec playerctl --player=spotify,cmus,%all volume .05- 
bindsym $mod+equal exec playerctl --player=spotify,cmus,%all volume .05+

#Music
set $music Action: [a]udacity [c]mus [e]artraining [r]eaper [s]potify
bindsym $mod+u mode "$music"
mode "$music" {
    bindsym a exec audacity-xdg; mode "default"
    bindsym c exec i3-msg workspace $ws10; exec $term -e cmus; mode "default"
    bindsym e exec eartraining; mode "default"
    bindsym r exec reaper; mode "default"
    bindsym s exec i3-msg workspace $ws10; exec spotify; mode "default"

    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Browser
bindsym $mod+b exec brave --force-device-scale-factor=1.22
bindsym $mod+shift+b exec librewolf-xdg
bindsym $mod+t exec torbrowser-launcher
bindsym $mod+w exec $term -e w3m-xdg lite.duckduckgo.com/lite

#Communication + Some OS controls
bindsym $mod+m exec mailspring 
bindsym $mod+shift+m exec $term -e neomutt
set $mega Action: [s]ignal s[l]ack [d]iscord [e]lement | [i]3lock s[u]spend
bindsym $mod+s mode "$mega"
mode "$mega" {
    bindsym s exec signal-desktop; exec i3-msg workspace $ws8; mode "default"
    bindsym l exec slack; exec i3-msg workspace $ws8; mode "default"
    bindsym d exec discord; exec i3-msg workspace $ws8; mode "default"
    bindsym e exec element; exec i3-msg workspace $ws8; mode "default"
    bindsym i exec i3lock -i ~/pictures/wallpapers/lone-tree.jpg; mode "default"
    bindsym u exec systemctl suspend; mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

# More OS Control
bindsym $mod+shift+q exec confirm "quit i3? " i3-msg exit
bindsym $mod+shift+s exec confirm "shutdown? " shutdown now
bindsym $mod+shift+r exec confirm "reboot? " reboot

#Games
set $games Action: [l]ichess [m]inecraft [s]team
bindsym $mod+shift+g mode "$games"
mode "$games" {
    bindsym l exec lichess; mode "default"
    bindsym m exec minecraft-launcher-xdg; mode "default"
    bindsym s exec steam-xdg; mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Video Consumption
set $entertainment Action: [c]astero [l]bry [o]dysee [p]ipe-viewer [n]ewsboat [y]tfzf
bindsym $mod+n mode "$entertainment"
mode "$entertainment" {
    bindsym c exec castero-i3; exec i3-msg workspace $ws10; mode "default"
    bindsym l exec lbry; exec i3-msg workspace $ws9; mode "default"
    bindsym n exec $term -e newsboat -u .config/newsboat/urls -c .config/newsboat/cache.db -C .config/newsboat/config; exec i3-msg workspace $ws9; mode "default"
    bindsym o exec brave --profile-directory=Default --app-id=hfhflbfbdbfkgkjgjjioheljacjjlcff; exec i3-msg workspace $ws9; mode "default"
    bindsym p exec $term -e pipe-viewer; mode "default"
    bindsym y exec $term_iso -e ytfzf --detach; exec i3-msg workspace $ws9; mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Toggles
bindsym $mod+grave exec wifi-radio-toggle
bindsym $mod+e exec espanso-toggle
bindsym $mod+shift+n exec nextcloud-sync-toggle

#Utility
bindsym $mod2+h exec $term -e htop
bindsym $mod2+d exec swat-dash
bindsym $mod2+shift+d exec snapdrop
bindsym $mod+shift+c exec brave --profile-directory=Default --app-id=hmplmobicmfaiecgedkffnohgbjpaaod
bindsym $mod2+c exec calc-toggle


# Screenshots
bindsym --release Print exec scrot --select -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'
bindsym --release $mod2+Print exec scrot -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'

#--------------------------------------------------
#-----------Startup and Program Settings-----------
#--------------------------------------------------

#Startup
exec pulseaudio-startup-script
exec picom
exec urxvtd -q
exec dunst
exec redshift
exec nm-applet
exec nm-applet
exec blueman-applet
# exec mailspring -b
exec --no-startup-id libinput-gestures-setup start
# exec safeeyes
# exec aw-qt

# exec --no-startup-id i3-msg 'workspace $ws10; exec $term -e cmus;'

for_window [title="Library"] floating enable
for_window [Class="rpi-imager"] floating enable
for_window [Class="Blueman-manager"] floating enable
for_window [Class="Blueman-manager"] resize set 800 500
for_window [Class="Pavucontrol"] floating enable
for_window [title="^Polls$"] floating enable
for_window [title="^Console window for.*$"] floating enable

assign [title="Tor Browser"] $ws7
assign [class="discord"] $ws8
assign [class="Slack"] $ws8
assign [class="Signal"] $ws8
assign [class="Element"] $ws8
assign [title="pipe-viewer"] $ws9
assign [title="ytfzf"] $ws9
assign [class="LBRY"] $ws9
assign [title="newsboat"] $ws9
assign [title="castero"] $ws10
assign [title="^Spotify"] $ws10
assign [title="cmus"] $ws10

for_window [instance="notes"] floating enable
for_window [instance="notes"] resize set 1200 900
for_window [instance="notes"] move scratchpad
for_window [instance="notes"] border pixel 8
# exec --no-startup-id $term -name notes -e tmux new-session \; \
#          send-keys 'nvim ~/documents/wiki/index.wiki' C-m \; \
#          split-window -v -p 25 \; \
#          # split-window -h -p 30 \; \
#          # send-keys 'bc -lq' C-m C-l \;
# exec --no-startup-id $term -name notes -e nvim ~/documents/wiki/index.wiki

for_window [instance="calc"] floating enable
for_window [instance="calc"] resize set 800 400
for_window [instance="calc"] move scratchpad
for_window [instance="calc"] border pixel 8
# exec --no-startup-id $term -name calc -e bc -lq

#--------------------------------------------------
#-------------------Movement---------------------
#--------------------------------------------------

# Kill focused window
bindsym $mod+q kill

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+shift+h move left
bindsym $mod+shift+j move down
bindsym $mod+shift+k move up
bindsym $mod+shift+l move right

# split in horizontal orientation
bindsym $mod+g split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+shift+f fullscreen toggle

# toggle tiling / floating
bindsym $mod+f floating toggle

# change focus between tiling / floating windows
bindsym $mod+shift+space focus mode_toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+d layout tabbed
bindsym $mod+shift+d layout toggle split

#Scratchpad
bindsym $mod+y scratchpad show
bindsym $mod+shift+y move scratchpad

#Set workspace names
set $ws1 "1:"
set $ws2 "2:"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10:"

# move through workspaces sequentially
bindsym $mod+z workspace prev
bindsym $mod+x workspace next

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# move focused container to workspace
bindsym $mod+shift+1 move container to workspace $ws1
bindsym $mod+shift+2 move container to workspace $ws2
bindsym $mod+shift+3 move container to workspace $ws3
bindsym $mod+shift+4 move container to workspace $ws4
bindsym $mod+shift+5 move container to workspace $ws5
bindsym $mod+shift+6 move container to workspace $ws6
bindsym $mod+shift+7 move container to workspace $ws7
bindsym $mod+shift+8 move container to workspace $ws8
bindsym $mod+shift+9 move container to workspace $ws9
bindsym $mod+shift+0 move container to workspace $ws10

bindsym $mod+r restart

bindsym $mod2+shift+h resize shrink width 10 px or 10 ppt
bindsym $mod2+shift+j resize grow height 10 px or 10 ppt
bindsym $mod2+shift+k resize shrink height 10 px or 10 ppt
bindsym $mod2+shift+l resize grow width 10 px or 10 ppt

bar {
    font pango:DejaVu Sans Mono, FontAwesome 18
    strip_workspace_numbers yes
    position top
    status_command i3status-rs
    colors {
        separator #928374
        background #282828
        statusline #ebdbb2
        focused_workspace #689d6a #689d6a #282828 #ffffff
        active_workspace #1d2021 #1d2021 #928374 #ffffff
        inactive_workspace #32302f #32302f #928374 #888888
        urgent_workspace #cc241d #cc241d #ebdbb2 #ffffff
    }
}

# bar {
#     font pango:DejaVu Sans Mono, FontAwesome 18
#      strip_workspace_numbers yes
#      position top
#     status_command bumblebee-status \
#      -m pasource pasink battery time \
#      -p time.format="%H:%M" \
#      -t gruvbox
# }

#--------------------------------------------------
#--------------Peripheral Controls-----------------
#--------------------------------------------------

# adjust screen brightness
bindsym XF86MonBrightnessUp exec xbacklight +1
bindsym XF86MonBrightnessDown exec xbacklight -1
bindsym shift+XF86MonBrightnessUp exec xbacklight +3
bindsym shift+XF86MonBrightnessDown exec xbacklight -3
bindsym $mod2+j exec xbacklight -3
bindsym $mod2+k exec xbacklight +3
bindsym $mod+shift+a exec xbacklight -set .00206254 #Min Brightness

# Use pactl to adjust volume in PulseAudio.
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5% && $refresh_i3status
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5% && $refresh_i3status

bindsym shift+XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +1% && $refresh_i3status
bindsym shift+XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -1% && $refresh_i3status

bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status
bindsym XF86AudioMicMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

#--------------------------------------------------
#-------------------Theming---------------------
#--------------------------------------------------

# Wallpaper
exec wallpaper.sh
#exec feh --bg-fill --no-fehbg --recursive --randomize ~/pictures/wallpapers

# set primary gruvbox colorscheme colors
set $bg #282828
set $red #cc241d
set $green #98971a
set $yellow #d79921
set $blue #458588
set $purple #b16286
set $aqua #689d68
set $gray #a89984
set $darkgray #1d2021

# class                 border|backgr|text|indicator|child_border
client.focused #689d6a #689d6a #282828 #282828
client.focused_inactive #1d2021 #1d2021 #928374 #282828
client.unfocused #32302f #32302f #928374 #282828
client.urgent #cc241d #cc241d #ebdbb2 #282828
