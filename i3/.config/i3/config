#--------------------------------------------------
#-----------------General Settings-----------------
#--------------------------------------------------

set $e exec --no-startup-id

set $mod Mod4
set $mod2 Mod1
set $mod3 Mod3
set $term urxvtc
set $term_iso alacritty
set $term2 alacritty

floating_modifier $mod

font pango:Deja Vu Sans Mono 16
smart_gaps on 
smart_borders on
gaps inner 7
gaps outer 0
for_window [class="^.*"] border pixel 4

#--------------------------------------------------
#-----------------Program Keybinds----------------
#--------------------------------------------------

#Terminals
bindsym $mod+Return $e $term
bindsym $mod2+Return $e $term2

#Rofi
bindsym $mod+space $e rofi -show drun -show-icons -drun-display-format {name}
bindsym $mod2+space $e rofi -show run

#Menus
bindsym $mod+semicolon $e passmenu
bindsym $mod+apostrophe $e sadmenu

#Camera and Audio
bindsym $mod2+v $e guvcview
bindsym $mod+shift+v $e pavucontrol

#Editor
bindsym $mod+i $e $term -e nvim
bindsym $mod+shift+i $e $term -e sudo nvim
bindsym $mod+e $e emacs
bindsym $mod+o $e onlyoffice-desktopeditors
bindsym $mod+shift+o $e obsidian
bindsym $mod3+c $e vscodium
bindsym $mod+w $e vimwiki-toggle

#File Manager
bindsym $mod+a $e $term -e ~/code/scripts/lf/lf
bindsym $mod2+f $e nautilus

#Audio Consumption
bindsym $mod+s $e music-toggle
bindsym $mod+bracketleft $e "playerctl --player=spotify,cmus,%any previous"
bindsym $mod+bracketright $e "playerctl --player=spotify,cmus,%any next"
bindsym $mod+minus $e playerctl --player=spotify,cmus,%all volume .05- 
bindsym $mod+equal $e playerctl --player=spotify,cmus,%all volume .05+
bindsym $mod+slash $e spotifyd-spt
bindsym $mod+shift+slash $e spotifyd-toggle

#Music
set $music Action: [a]udacity ar[d]our [e]artraining [r]eaper | rofi-[b]eats [c]mus [s]potify s[p]otify-tui
bindsym $mod+u mode "$music"
mode "$music" {
    bindsym a $e $xdg/audacity-xdg; mode "default"
    bindsym d $e ardour6; mode "default"
    bindsym e $e brave --profile-directory=Default --app-id=acboifakfdfbjokchjihkcebeejogheg; mode "default"
    bindsym r $e reaper; mode "default"
    bindsym b $e rofi-beats; mode "default"
    bindsym c $e i3-msg workspace $ws10; $e $term -e cmus; mode "default"
    bindsym s $e i3-msg workspace $ws10; $e spotify; mode "default"
    bindsym p $e spotify-tui-launcher; mode "default"
    bindsym $mod+u mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Browser
bindsym $mod+b $e brave --force-device-scale-factor=1.15
bindsym $mod+shift+b $e librewolf
bindsym $mod+shift+t $e torbrowser-launcher
bindsym $mod+shift+w $e $term -e w3m-xdg lite.duckduckgo.com/lite
bindsym $mod2+l $e librewolf lesswrong.com

#Communication
bindsym $mod+m $e mailspring-toggle
bindsym $mod+shift+m $e $term -e neomutt
set $mega Action: [d]iscord [e]lement [f]erdi s[l]ack [s]ignal
bindsym $mod+c mode "$mega"
mode "$mega" {
    bindsym d $e discord; $e i3-msg workspace $ws8; mode "default"
    bindsym e $e element-desktop; $e i3-msg workspace $ws8; mode "default"
    bindsym f $e ferdi; $e i3-msg workspace $ws1; mode "default"
    bindsym l $e slack; $e i3-msg workspace $ws8; mode "default"
    bindsym s $e signal-desktop; $e i3-msg workspace $ws8; mode "default"
    bindsym $mod+c mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

# OS Control
bindsym $mod+shift+q $e confirm "quit i3? " i3-msg exit
bindsym $mod+shift+s $e confirm "shutdown? " shutdown now
bindsym $mod+shift+r $e confirm "reboot? " reboot
bindsym $mod2+i $e i3lock -i ~/pictures/wallpapers/mountains.png
#bindsym $mod2+s $e confirm "suspend? " systemctl suspend

#Games
set $games Action: [l]ichess [m]inecraft [t]etris
bindsym $mod+shift+g mode "$games"
mode "$games" {
    bindsym t $e $term -e netris -k "hHklLJjs frn"; mode "default"
    bindsym l $e brave --profile-directory=Default --app-id=pdihgkikjgccndbckbcgjmcnpkockcjg; mode "default"
    bindsym m $e minecraft-launcher-xdg; mode "default"
    bindsym $mod+shift+g mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Video Entertainment
set $entertainment Action: [l]bry [p]ipe-viewer [n]ewsboat [y]tfzf
bindsym $mod+n mode "$entertainment"
mode "$entertainment" {
    bindsym l $e lbry; $e i3-msg workspace $ws9; mode "default"
    bindsym n $e $term -e newsboat -u .config/newsboat/urls -c .config/newsboat/cache.db -C .config/newsboat/config; $e i3-msg workspace $ws9; mode "default"
    bindsym p $e $term -e pipe-viewer; $e i3-msg workspace $ws9; mode "default"
    bindsym y $e $term_iso -e ytfzf --detach; $e i3-msg workspace $ws9; mode "default"
    bindsym $mod+n mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}
bindsym $mod+p $e $term -e pipe-viewer --resolution=480; $e i3-msg workspace $ws9
bindsym $mod+shift+p $e gtk-pipe-viewer

#Toggles
bindsym XF86WLAN $e wifi-radio-toggle
bindsym XF86Bluetooth $e bluetooth toggle
bindsym $mod2+b $e blueman-manager
bindsym $mod2+n $e nm-applet-toggle
bindsym $mod+shift+e $e espanso-toggle
bindsym $mod+shift+n $e nextcloud-sync-toggle

#Utility
bindsym $mod+t $e todoist-toggle
bindsym $mod2+h $e $term -e htop
bindsym $mod2+d $e brave --profile-directory=Default --app-id=aaplghibfpkoiagapjbmhemjhkehncib # Swat Dash
bindsym $mod2+s $e brave --profile-directory=Default --app-id=ikpmlgdcejalmjnfbahhijemkcgljabf # Snapdrop
bindsym $mod+shift+c $e calendar-toggle
bindsym $mod2+c $e calc-toggle
bindsym XF86Display $e feh --bg-fill --no-fehbg --recursive --randomize ~/pictures/wallpapers


# Screenshots
bindsym --release Print $e scrot --select -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'
bindsym --release $mod2+Print $e scrot -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'

#--------------------------------------------------
#-----------Startup and Program Settings-----------
#--------------------------------------------------

#Startup
$e picom
$e redshift
$e urxvtd -q
$e dunst
$e blueman-applet
$e mailspring
$e libinput-gestures-setup start
# $e safeeyes

for_window [title="^Library"] floating enable
for_window [Class="rpi-imager"] floating enable
for_window [Class="Blueman-manager"] floating enable
for_window [Class="Blueman-manager"] resize set 800 500
for_window [Class="Pavucontrol"] floating enable
for_window [title="^Polls$"] floating enable
for_window [title="^Console window for.*$"] floating enable

assign [class="Mailspring"] $ws1
assign [class="ferdi"] $ws1
assign [title="Tor Browser"] $ws7
assign [class="discord"] $ws8
assign [class="Slack"] $ws8
assign [class="Signal"] $ws8
assign [class="Element"] $ws8
assign [title="pipe-viewer"] $ws9
assign [title="ytfzf"] $ws9
assign [class="LBRY"] $ws9
assign [title="newsboat"] $ws9
assign [title="cmus"] $ws10
assign [title="spt"] $ws10

#Rofi-Beats
for_window [title="radio-mpv"] move scratchpad

#Vimwiki
for_window [instance="notes"] floating enable
for_window [instance="notes"] resize set 1200 900
for_window [instance="notes"] move scratchpad
for_window [instance="notes"] border pixel 8

#Todoist
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] move scratchpad
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] floating enable
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] resize set 1500 1000
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] border pixel 8

#Calendar
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] move scratchpad
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] floating enable
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] resize set 1800 1000
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] border pixel 8
# $e $term -name notes -e tmux new-session \; \
#          send-keys 'nvim ~/documents/wiki/index.wiki' C-m \; \
#          split-window -v -p 25 \; \
#          # split-window -h -p 30 \; \
#          # send-keys 'bc -lq' C-m C-l \;
# $e $term -name notes -e nvim ~/documents/wiki/index.wiki

for_window [instance="calc"] floating enable
for_window [instance="calc"] resize set 800 400
for_window [instance="calc"] move scratchpad
for_window [instance="calc"] border pixel 8
# $e $term -name calc -e bc -lq

#--------------------------------------------------
#-------------------Movement---------------------
#--------------------------------------------------

# Kill focused window
bindsym $mod+q kill

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+shift+h move left
bindsym $mod+shift+j move down
bindsym $mod+shift+k move up
bindsym $mod+shift+l move right

# split in horizontal orientation
bindsym $mod+g split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+shift+f fullscreen toggle

# toggle tiling / floating
bindsym $mod+f floating toggle

# change focus between tiling / floating windows
bindsym $mod+shift+space focus mode_toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+d layout tabbed
bindsym $mod+shift+d layout toggle split

#Scratchpad
bindsym $mod+y scratchpad show
bindsym $mod+shift+y move scratchpad

#Set workspace names
set $ws1 "1:"
set $ws2 "2:"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10:"

# move through workspaces sequentially
bindsym $mod+z workspace prev
bindsym $mod+x workspace next

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# move focused container to workspace
bindsym $mod+shift+1 move container to workspace $ws1
bindsym $mod+shift+2 move container to workspace $ws2
bindsym $mod+shift+3 move container to workspace $ws3
bindsym $mod+shift+4 move container to workspace $ws4
bindsym $mod+shift+5 move container to workspace $ws5
bindsym $mod+shift+6 move container to workspace $ws6
bindsym $mod+shift+7 move container to workspace $ws7
bindsym $mod+shift+8 move container to workspace $ws8
bindsym $mod+shift+9 move container to workspace $ws9
bindsym $mod+shift+0 move container to workspace $ws10

bindsym $mod+r restart

bindsym $mod2+shift+h resize shrink width 3 px or 3 ppt
bindsym $mod2+shift+j resize grow height 3 px or 3 ppt
bindsym $mod2+shift+k resize shrink height 3 px or 3 ppt
bindsym $mod2+shift+l resize grow width 3 px or 3 ppt

bar {
    font pango:DejaVu Sans Mono, FontAwesome 16
    strip_workspace_numbers yes
    position top
    status_command i3status-rs
    colors {
        separator #928374
        background #282828
        statusline #ebdbb2
        focused_workspace #689d6a #689d6a #282828 #ffffff
        active_workspace #1d2021 #1d2021 #928374 #ffffff
        inactive_workspace #32302f #32302f #928374 #888888
        urgent_workspace #cc241d #cc241d #ebdbb2 #ffffff
    }
}

#--------------------------------------------------
#--------------Peripheral Controls-----------------
#--------------------------------------------------

# adjust screen brightness
bindsym XF86MonBrightnessUp $e xbacklight +1
bindsym XF86MonBrightnessDown $e xbacklight -1
bindsym shift+XF86MonBrightnessUp $e xbacklight +3
bindsym shift+XF86MonBrightnessDown $e xbacklight -3
bindsym $mod2+j $e xbacklight -3
bindsym $mod2+k $e xbacklight +3
bindsym $mod+shift+a $e xbacklight -set .00206254 #Min Brightness

# Use pactl to adjust volume in PulseAudio.
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume $e pactl set-sink-volume @DEFAULT_SINK@ +1% && $refresh_i3status
bindsym XF86AudioLowerVolume $e pactl set-sink-volume @DEFAULT_SINK@ -5% && $refresh_i3status

# bindsym shift+XF86AudioRaiseVolume $e pactl set-sink-volume @DEFAULT_SINK@ +5% && $refresh_i3status
# bindsym shift+XF86AudioLowerVolume $e pactl set-sink-volume @DEFAULT_SINK@ -1% && $refresh_i3status

bindsym XF86AudioMute $e pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status
bindsym XF86AudioMicMute $e pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

#--------------------------------------------------
#-------------------Theming---------------------
#--------------------------------------------------

# Wallpaper
exec feh --bg-fill --no-fehbg --recursive --randomize ~/pictures/wallpapers

# set primary gruvbox colorscheme colors
set $bg #282828
set $red #cc241d
set $green #98971a
set $yellow #d79921
set $blue #458588
set $purple #b16286
set $aqua #689d68
set $gray #a89984
set $darkgray #1d2021

# class                 border|backgr|text|indicator|child_border
client.focused #689d6a #689d6a #282828 #282828
client.focused_inactive #1d2021 #1d2021 #928374 #282828
client.unfocused #32302f #32302f #928374 #282828
client.urgent #cc241d #cc241d #ebdbb2 #282828
