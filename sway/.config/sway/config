#--------------------------------------------------
#-----------------General Settings-----------------
#--------------------------------------------------

set $mod Mod4
set $mod2 Mod1
set $mod3 Mod3
set $term alacritty msg create-window
set $term2 urxvt

floating_modifier $mod

font pango:BlexMono Nerd Font 13
smart_gaps on 
smart_borders on
gaps inner 7
gaps outer 0
default_border pixel 4

#--------------------------------------------------
#-----------------Program Keybinds----------------
#--------------------------------------------------

#Terminals
bindsym $mod+return exec $term
bindsym $mod+shift+return exec $term2
bindsym $mod2+a exec alacritty --class alacritty-server --title alacritty-server

#Menus
bindsym $mod+space exec rofi -show drun -show-icons -drun-display-format {name}
bindsym $mod+semicolon exec rofi-pass
bindsym $mod+apostrophe exec sadmenu
bindsym $mod2+b exec bluetooth on; exec blueman-manager

#Camera and Audio
bindsym $mod2+v exec guvcview
bindsym $mod+shift+v exec pavucontrol

#Editor
bindsym $mod+i exec $term -e nvim
bindsym $mod+shift+i exec $term -e sudo nvim
bindsym $mod+e exec emacs
bindsym $mod+o exec onlyoffice-desktopeditors
bindsym $mod+shift+o exec obsidian
bindsym $mod3+c exec vscodium
bindsym $mod+w exec toggler notes

#File Manager
bindsym $mod+a exec $term -e ~/code/scripts/lf/lf
bindsym $mod2+f exec nautilus

#Audio Consumption
bindsym $mod+s exec toggler music
bindsym $mod+bracketleft exec "playerctl --player=spotify,cmus,%any previous"
bindsym $mod+bracketright exec "playerctl --player=spotify,cmus,%any next"
bindsym $mod+minus exec "playerctl --player=spotify,cmus,%all volume .05-"
bindsym $mod+equal exec "playerctl --player=spotify,cmus,%all volume .05+"
bindsym $mod+slash exec toggler spotifyd-spt
bindsym $mod+shift+slash exec toggler spotifyd

#Music
set $music Action: [a]udacity ar[d]our [e]artraining [r]eaper | rofi-[b]eats [c]mus [n]uclear [s]potify s[p]otify-tui
bindsym $mod+u mode "$music"
mode "$music" {
    bindsym a exec xdg-launch audacity; mode "default"
    bindsym d exec ardour6; mode "default"
    bindsym e exec brave --profile-directory=Default --app-id=acboifakfdfbjokchjihkcebeejogheg; mode "default"
    bindsym r exec reaper; mode "default"
    bindsym b exec rofi-beats; mode "default"
    bindsym c workspace 10; exec $term -e cmus; mode "default"
    bindsym n workspace 10; exec nuclear; mode "default"
    bindsym s workspace 10; exec spotify; mode "default"
    bindsym p exec toggler spotify-tui; mode "default"
    bindsym $mod+u mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Browser
bindsym $mod+b exec brave --force-device-scale-factor=1
bindsym $mod+shift+b exec librewolf
bindsym $mod+shift+t exec torbrowser-launcher
bindsym $mod+shift+w exec $term -e xdg-launch w3m "lite.duckduckgo.com/lite"
bindsym $mod2+l exec brave lesswrong.com

#Communication
bindsym $mod+m exec toggler gmail
bindsym $mod+shift+m exec $term -e neomutt
set $mega Action: [d]iscord [e]lement s[l]ack [s]ignal
bindsym $mod+c mode "$mega"
mode "$mega" {
    bindsym d exec discord; workspace 8; mode "default"
    bindsym e exec element-desktop; workspace 8; mode "default"
    bindsym l exec slack; workspace 8; mode "default"
    bindsym s exec signal-desktop; workspace 8; mode "default"
    bindsym $mod+c mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

# OS Control
set $quit Quit?: [y]es [n]o
bindsym $mod+shift+q mode "$quit"
mode "$quit" {
    bindsym y exit
    bindsym n exec mode "default"
    bindsym $mod+shift+q mode "default"
    bindsym Escape mode "default"
    bindsym Return exit
}
set $shutdown Shutdown?: [y]es [n]o
bindsym $mod+shift+s mode "$shutdown"
mode "$shutdown" {
    bindsym y exec shutdown now
    bindsym n exec mode "default"
    bindsym $mod+shift+s mode "default"
    bindsym Escape mode "default"
    bindsym Return mode exec shutdown now
}
set $reboot Reboot?: [y]es [n]o
bindsym $mod+shift+r mode "$reboot"
mode "$reboot" {
    bindsym y exec reboot
    bindsym n exec mode "default"
    bindsym $mod+shift+r mode "default"
    bindsym Escape mode "default"
    bindsym Return exec reboot
}
bindsym $mod2+i exec i3lock -i ~/pictures/wallpapers/mountains.png

#Games
set $games Action: [h]eroic [l]ichess [m]inecraft [s]team [t]etris
bindsym $mod+shift+g mode "$games"
mode "$games" {
    bindsym h exec heroic; mode "default"
    bindsym l exec brave --profile-directory=Default --app-id=pdihgkikjgccndbckbcgjmcnpkockcjg; mode "default"
    bindsym m exec xdg-launch minecraft-launcher; mode "default"
    bindsym s exec steam; mode "default"
    bindsym t exec $term -e netris -k "hHklLJjs frn"; mode "default"
    bindsym $mod+shift+g mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}

#Video Entertainment
set $entertainment Action: [l]bry [n]ewsboat [p]ipe-viewer [y]tfzf
bindsym $mod+n mode "$entertainment"
mode "$entertainment" {
    bindsym l exec lbry; workspace 9; mode "default"
    bindsym n exec $term -e newsboat -u .config/newsboat/urls -c .config/newsboat/cache.db -C .config/newsboat/config; workspace 9; mode "default"
    bindsym p exec $term -e pipe-viewer; workspace 9; mode "default"
    bindsym y exec $term -e ytfzf --detach; workspace 9; mode "default"
    bindsym $mod+n mode "default"
    bindsym Escape mode "default"
    bindsym Return mode "default"
}
bindsym $mod+p exec $term -e pipe-viewer --resolution=480; workspace 9
bindsym $mod+shift+p exec gtk-pipe-viewer

#Toggles
bindsym XF86WLAN exec wifi toggle
bindsym XF86Bluetooth exec bluetooth off
bindsym $mod2+n exec toggler nm-applet
bindsym $mod+shift+e exec toggler espanso
bindsym $mod+grave exec dunstctl close
# bindsym $mod2+r exec toggler redshift

#Utility
bindsym $mod+t exec toggler todoist
bindsym $mod2+h exec $term -e htop
bindsym $mod2+d exec gtk-launch dash
bindsym $mod2+s exec gtk-launch snapdrop
bindsym $mod+shift+c exec toggler calendar
bindsym $mod2+c exec toggler bc

# Screenshots
bindsym --release Print exec grim --select -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'
bindsym --release $mod2+Print exec grim -e 'mv $f ~/pictures/screenshots/%Y-%m-%d-%H-%M-%S.png'

#--------------------------------------------------
#-----------Startup and Program Settings-----------
#--------------------------------------------------

#Startup
exec alacritty --class alacritty-server --title alacritty-server
exec dunst
exec blueman-applet
# exec mailspring
exec libinput-gestures-setup start

for_window [app_id="blueman-manager"] floating enable
for_window [app_id="blueman-manager"] resize set 800 500
for_window [app_id="pavucontrol"] floating enable

assign [title="Tor Browser"] 7
assign [class="discord"] 8
assign [class="Slack"] 8
assign [class="Signal"] 8
assign [class="Element"] 8
assign [title="pipe-viewer"] 9
assign [title="ytfzf"] 9
assign [class="LBRY"] 9
assign [title="newsboat"] 9
assign [title="cmus"] 10
assign [title="spt"] 10

#Rofi-Beats
for_window [title="radio-mpv"] move scratchpad

#Alacritty Server
for_window [app_id="alacritty-server"] move scratchpad

#Vimwiki
for_window [app_id="notes"] floating enable
for_window [app_id="notes"] resize set 1200 900
for_window [app_id="notes"] move scratchpad
for_window [app_id="notes"] border pixel 8

#Todoist
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] move scratchpad
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] floating enable
for_window [instance="crx_elldfnmogicegdcphgljaoaklkpcnbnn"] resize set 1700 1020

#Calendar
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] move scratchpad
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] floating enable
for_window [instance="crx_kjbdgfilnfhdoflbpgamdcdgpehopbep"] resize set 1900 1020

#Gmail Web
for_window [instance="crx_fmgjjmmmlfnkbppncabfkddbjimcfncm"] move scratchpad
for_window [instance="crx_fmgjjmmmlfnkbppncabfkddbjimcfncm"] floating enable
for_window [instance="crx_fmgjjmmmlfnkbppncabfkddbjimcfncm"] resize set 1900 1020

for_window [app_id="calc"] floating enable
for_window [app_id="calc"] resize set 800 400
for_window [app_id="calc"] move scratchpad
for_window [app_id="calc"] border pixel 8

#--------------------------------------------------
#-------------------Movement---------------------
#--------------------------------------------------

# Kill focused window
bindsym $mod+q kill

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+shift+h move left
bindsym $mod+shift+j move down
bindsym $mod+shift+k move up
bindsym $mod+shift+l move right

# split in horizontal orientation
bindsym $mod+g split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+shift+f fullscreen toggle

# toggle tiling / floating
bindsym $mod+f floating toggle

# change focus between tiling / floating windows
bindsym $mod+shift+space focus mode_toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+d layout tabbed
bindsym $mod+shift+d layout toggle split

#Scratchpad
bindsym $mod+y scratchpad show
bindsym $mod+shift+y move scratchpad

# move through workspaces sequentially
bindsym $mod+z workspace prev
bindsym $mod+x workspace next

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+shift+1 move container to workspace 1
bindsym $mod+shift+2 move container to workspace 2
bindsym $mod+shift+3 move container to workspace 3
bindsym $mod+shift+4 move container to workspace 4
bindsym $mod+shift+5 move container to workspace 5
bindsym $mod+shift+6 move container to workspace 6
bindsym $mod+shift+7 move container to workspace 7
bindsym $mod+shift+8 move container to workspace 8
bindsym $mod+shift+9 move container to workspace 9
bindsym $mod+shift+0 move container to workspace 10

bindsym $mod+r reload

bindsym $mod2+shift+h resize shrink width 3 px or 3 ppt
bindsym $mod2+shift+j resize grow height 3 px or 3 ppt
bindsym $mod2+shift+k resize shrink height 3 px or 3 ppt
bindsym $mod2+shift+l resize grow width 3 px or 3 ppt

bar {
    font pango:BlexMono Nerd Font 13
    strip_workspace_numbers yes
    position top
    status_command i3status-rs
    colors {
        separator #928374
        background #282828
        statusline #ebdbb2
        focused_workspace #689d6a #689d6a #282828
        active_workspace #1d2021 #1d2021 #928374
        inactive_workspace #32302f #32302f #928374
        urgent_workspace #cc241d #cc241d #ebdbb2
    }
}

#--------------------------------------------------
#--------------Peripheral Controls-----------------
#--------------------------------------------------

# adjust screen brightness
bindsym XF86MonBrightnessUp exec xbacklight -inc .5
bindsym XF86MonBrightnessDown exec xbacklight -dec .5
bindsym $mod2+j exec xbacklight -dec 1
bindsym $mod2+k exec xbacklight -inc 1
bindsym $mod+shift+a exec xbacklight -set .00206254 #Min Brightness

# Use pactl to adjust volume in PulseAudio.
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +1%
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%

bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle

#--------------------------------------------------
#-------------------Theming---------------------
#--------------------------------------------------

# Wallpaper
output * bg ~/pictures/wallpapers/lone-tree.jpg fill

# set primary gruvbox colorscheme colors
set $bg #282828
set $red #cc241d
set $green #98971a
set $yellow #d79921
set $blue #458588
set $purple #b16286
set $aqua #689d68
set $gray #a89984
set $darkgray #1d2021

# class                 border|backgr|text|indicator|child_border
client.focused #689d6a #689d6a #282828 #282828
client.focused_inactive #1d2021 #1d2021 #928374 #282828
client.unfocused #32302f #32302f #928374 #282828
client.urgent #cc241d #cc241d #ebdbb2 #282828

#--------------------------------------------------
#--------------Keyboard Layout---------------------
#--------------------------------------------------
input "type:keyboard" {
    xkb_layout us
    xkb_options altwin:swap_alt_win,caps:escape
}
input "1739:52619:SYNA8004:00_06CB:CD8B_Touchpad" {
    natural_scroll enabled
}
